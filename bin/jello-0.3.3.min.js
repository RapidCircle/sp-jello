var Jello=function(){return{}}();Jello.Files=function(){(function(){return{}})();throw"Not implemented"},Jello.List=function(){(function(){return{}})();throw"Not implemented"},Jello.ListItems=function(e){var t=function(){var e=null,t=function(){var t=$.Deferred();return e&&e.expiresOn>new Date?t.resolve(e):($.ajax({type:"POST",url:n+"/_api/contextinfo",headers:{accept:"application/json;odata=verbose"}}).done(function(r){var n=(new Date).getTime();e=r.d.GetContextWebInformation,e.expiresOn=n+1e3*r.d.GetContextWebInformation.FormDigestTimeoutSeconds-6e4,t.resolve(e)}).fail(function(e){console.log("Error fetching Request Digest. Some parts won't work."),t.reject(e)}),t.promise())};return{GetRequestDigest:t}}(),r={filter:null,expand:null,select:null,orderBy:null},n=e.site,o=e.list,i=e.contentType,a=function(e){var t=$.Deferred(),i="";return r.select||r.filter||r.expand||r.orderBy?(r.expand&&(i=i.length>0?i+"&"+r.expand:i+"?"+r.expand),r.select&&(i=i.length>0?i+"&"+r.select:i+"?"+r.select),r.filter&&(i=i.length>0?i+"&"+r.filter:i+"?"+r.filter),r.orderBy&&(i=i.length>0?i+"&"+r.orderBy:i+"?"+r.orderBy),e&&(i=i.length>0?i+"&$top="+e:i+"?$top="+e),r={filter:null,expand:null,select:null,orderBy:null}):i=e?"?$top="+e:"",url=n+"/_api/web/lists/getbytitle('"+o+"')/items"+i,$.ajax({type:"GET",headers:{accept:"application/json;odata=verbose"},url:url}).done(function(e){e.next=function(){var t=$.Deferred();return a(null,e.d.__next).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise()},e.prev=function(){var t=$.Deferred();return a(null,e.d.__prev).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise()},t.resolve(e)}).fail(function(e){t.reject(e)}),t.promise()},u=function(e){var t=$.Deferred();if(!e)throw"Provided ID is not valid";return $.ajax({type:"GET",headers:{accept:"application/json;odata=verbose"},url:n+"/_api/web/lists/getbytitle('"+o+"')/items("+e+")"}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t.promise()},s=function(e){var r=$.Deferred();return t.GetRequestDigest().then(function(t){e.__metadata={type:i};var a=JSON.stringify(e);$.ajax({type:"POST",headers:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose","X-RequestDigest":t},data:a,url:n+"/_api/web/lists/getbytitle('"+o+"')/items"}).done(function(e){r.resolve(e)}).fail(function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise()},l=function(e,r){r||(r="*");var i=$.Deferred();return t.GetRequestDigest().then(function(t){$.ajax({type:"POST",headers:{"X-RequestDigest":t,"X-HTTP-Method":"DELETE","If-Match":r},url:n+"/_api/web/lists/getbytitle('"+o+"')/items("+e+")"}).done(function(e){i.resolve(e)}).fail(function(e){i.reject(e)})},function(e){i.reject(e)}),i.promise()},c=function(e,r,a){a||(a="*");var u=$.Deferred();return t.GetRequestDigest().then(function(t){r.__metadata={type:i};var s=JSON.stringify(r);$.ajax({type:"POST",headers:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose","X-RequestDigest":t,"X-HTTP-Method":"MERGE","If-Match":a},data:s,url:n+"/_api/web/lists/getbytitle('"+o+"')/items("+e+")"}).done(function(e){u.resolve(e)}).fail(function(e){u.reject(e)})},function(e){u.reject(e)}),u.promise()},f=function(e){var t=$.Deferred();return e=e?"?"+e:"",$.ajax({type:"GET",headers:{accept:"application/json;odata=verbose"},url:n+"/_api/web/lists/getbytitle('"+o+"')/items"+e}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t.promise()},m=function(e){return r.filter="$filter="+e,this},d=function(e){return r.expand="$expand="+e,this},p=function(e){return r.select="$select="+e,this},T=function(e){return r.orderBy="$orderby="+e,this};return{get:a,getById:u,add:s,remove:l,update:c,query:f,where:m,expand:d,select:p,orderBy:T}},Jello.Taxonomy=function(e){if(!SP.Taxonomy)throw"SP.Taxonomy is not loaded. Please ensure SP.Taxonomy is loaded before proceeding.";if(!e.TermStore)throw"TermStore null or undefined";var t=e.TermStore,r=function(e){if(!e)throw"Term set ID null or undefined.";return $.Deferred(function(r){var n=SP.ClientContext.get_current(),o=SP.Taxonomy.TaxonomySession.getTaxonomySession(n),i=o.get_termStores(),a=i.getByName(t),u=a.getTermSet(e),s=u.getAllTerms();n.load(s),n.executeQueryAsync(function(){r.resolve(s)},function(e,t){r.reject(t)})})},n=function(e){if(!e||!e.Name||!e.GUID)throw"Name or GUID is null or undefined";return $.Deferred(function(r){var n=SP.ClientContext.get_current(),o=SP.Taxonomy.TaxonomySession.getTaxonomySession(n),i=o.get_termStores(),a=i.getByName(t),u=a.createGroup(e.Name,e.GUID);n.load(u),n.executeQueryAsync(function(){r.resolve(u)},function(e,t){r.reject(t)})})},o=function(e){if(!(e&&e.GroupGUID&&e.TermSetName&&e.TermSetGUID&&e.TermSetLCID))throw"One or more parameters null or undefined. Required parameters are GroupGUID, TermSetName, TermSetGUID, TermSetLCID";return $.Deferred(function(r){var n=SP.ClientContext.get_current(),o=SP.Taxonomy.TaxonomySession.getTaxonomySession(n),i=o.get_termStores(),a=i.getByName(t),u=a.getGroup(e.GroupGUID),s=u.createTermSet(e.TermSetName,e.TermSetGUID,e.TermSetLCID);n.load(s),n.executeQueryAsync(function(){r.resolve(s)},function(e,t){r.reject(t)})})},i=function(e){if(!(e&&e.TermSetGUID&&e.TermName&&e.TermLCID&&e.TermGUID))throw"One or more parameters null or undefined. Required parameters are TermSetGUID, TermName, TermLCID, TermGUID";return $.Deferred(function(r){var n=SP.ClientContext.get_current(),o=SP.Taxonomy.TaxonomySession.getTaxonomySession(n),i=o.get_termStores(),a=i.getByName(t),u=a.getTermSet(e.TermSetGUID),s=u.createTerm(e.TermName,e.TermLCID,e.TermGUID);s.set_isAvailableForTagging(e.isAvailableForTagging),n.load(s),n.executeQueryAsync(function(){r.resolve(s)},function(e,t){r.reject(t)})})},a=function(e){if(!e)throw"GUID is null or undefined.";return $.Deferred(function(t){var r='<View><Query><Where><Eq><FieldRef Name="IdForTerm"/><Value Type="Text">'+e+"</Value></Eq></Where></Query></View>",n=SP.ClientContext.get_current(),o=n.get_web().get_lists().getByTitle("TaxonomyHiddenList"),i=new SP.CamlQuery;i.set_viewXml(r);var a=o.getItems(i);n.load(a),n.executeQueryAsync(function(){for(var e=a.getEnumerator(),r=[];e.moveNext();){var n=e.get_current();r.push(n.get_id())}t.resolve(r)},function(e,r){t.reject(r)})})};return{getAllTerms:r,addTermGroup:n,addTermSet:o,addTerm:i,getWssIdFromGuid:a}},Jello.Web=function(){(function(){return{}})();throw"Not implemented"};