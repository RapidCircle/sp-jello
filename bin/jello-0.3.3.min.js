var Jello=function(){return{}}();Jello.Files=function(){var e=function(){var e=null,t=function(){var t=$.Deferred();return e&&e.expiresOn>new Date?t.resolve(e):($.ajax({type:"POST",url:siteUrl+"/_api/contextinfo",headers:{accept:"application/json;odata=verbose"}}).done(function(r){var n=(new Date).getTime();e=r.d.GetContextWebInformation,e.expiresOn=n+1e3*r.d.GetContextWebInformation.FormDigestTimeoutSeconds-6e4,t.resolve(e)}).fail(function(e){console.log("Error fetching Request Digest. Some parts won't work."),t.reject(e)}),t.promise())};return{GetRequestDigest:t}}(),t=function(t){return $.Deferred(function(r){$.when(e.GetRequestDigest()).then(function(e){var n=new SP.RequestExecutor(t.context),o={url:"_api/web/GetFileByServerRelativeUrl('"+encodeURIComponent(t.FileUrl.replace(/'/g,"''"))+"')/checkOutType",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(o){if(o=JSON.parse(o.body),0===o.d.CheckOutType)r.resolve(o);else{var i={url:"_api/web/GetFileByServerRelativeUrl('"+encodeURIComponent(t.FileUrl.replace(/'/g,"''"))+"')/CheckOut()",method:"POST",headers:{Accept:"application/json; odata=verbose","X-RequestDigest":e},contentType:"application/json;odata=verbose",success:function(e){r.resolve(e)},error:function(e){r.reject(e)}};n.executeAsync(i)}},error:function(e){r.reject(e)}};n.executeAsync(o)})})},r=function(t){return $.Deferred(function(r){$.when(e.GetRequestDigest()).then(function(e){t.Comments=t.Comments?t.Comments:"Auto check-in";var n=new SP.RequestExecutor(t.context),o={url:"_api/web/GetFileByServerRelativeUrl('"+encodeURIComponent(t.FileUrl.replace(/'/g,"''"))+"')/CheckIn(comment='"+t.Comments+"', checkintype=0)",method:"POST",headers:{Accept:"application/json; odata=verbose","X-RequestDigest":e},contentType:"application/json;odata=verbose",success:function(e){r.resolve(e)},error:function(e){r.reject(e)}};n.executeAsync(o)})})},n=function(e,t){return $.Deferred(function(r){var n=new SP.RequestExecutor(e),o={url:t,method:"GET",binaryStringResponseBody:!0,success:function(e){r.resolve(e.body)},error:function(e){r.reject(JSON.stringify(e))}};n.executeAsync(o)})},o=function(t,r,n,o,i){return $.Deferred(function(a){$.when(e.GetRequestDigest()).done(function(e){i=i?i:"false";var s=new SP.RequestExecutor(t),c={url:"_api/web/GetFolderByServerRelativeUrl('"+encodeURIComponent(r.replace(/'/g,"''"))+"')/Files/Add(url='"+n+"',overwrite="+i+")",method:"POST",headers:{Accept:"application/json; odata=verbose","X-RequestDigest":e},contentType:"application/json;odata=verbose",binaryStringRequestBody:!0,body:o,success:function(e){a.resolve(e)},error:function(e){a.reject(o)}};s.executeAsync(c)})})},i=function(t){return $.Deferred(function(r){$.when(e.GetRequestDigest()).done(function(e){t.DestLibraryRelativePath=t.DestLibraryRelativePath.replace(/'/g,"''"),t.DestFileName=t.DestFileName.replace(/'/g,"''");var n=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/GetByTitle('"+t.SrcLibraryName+"')/GetItemById('"+t.SrcItemId+"')/File/copyTo(strNewUrl = '"+encodeURIComponent(t.DestLibraryRelativePath+"/"+t.DestFileName)+"',bOverWrite = "+t.boolReplace+")";$.ajax({cache:!1,url:n,type:"POST",headers:{accept:"application/json;odata=verbose","X-RequestDigest":e,"content-Type":"application/json;odata=verbose"},success:function(e){r.resolve(e)},error:function(e){r.reject(e)}})})})},a=function(t){return $.Deferred(function(r){$.when(e.GetRequestDigest(),RC.FileService.CheckOutFile(t)).done(function(e){var n=_spPageContextInfo.webAbsoluteUrl+"/_api/web/GetFileByServerRelativeUrl('"+encodeURIComponent(t.FileUrl.replace(/'/g,"''"))+"')/ListItemAllFields";$.ajax({url:n,type:"PATCH",headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":e,"X-Http-Method":"PATCH","If-Match":"*"},data:t.UpdateData,success:function(e){var n=JSON.parse(t.UpdateData);if(n.FileLeafRef){var o=t.FileUrl.split("/");o[o.length-1]=n.FileLeafRef,t.FileUrl=o.join("/")}$.when(RC.FileService.CheckInFile(t)).done(function(e){r.resolve(e)}).fail(function(e){r.reject(e)})},error:function(e){r.reject(e)}})}).fail(function(e){r.reject(e)})})},s=function(e){return $.Deferred(function(t){$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_api/web/GetFileByServerRelativeUrl('"+encodeURIComponent(e.FileUrl.replace(/'/g,"''"))+"')/approve(comment='')",type:"Post",headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"If-Match":"*"},success:function(e){t.resolve(e)},error:function(e){t.reject(e)}})})},c=function(e){return $.Deferred(function(t){$.ajax({cache:!1,url:_spPageContextInfo.webAbsoluteUrl+"/_api/web/GetFileByServerRelativeUrl('"+encodeURIComponent(e.FileUrl.replace(/'/g,"''"))+"')/ListItemAllFields?"+e.ODataQuery,headers:{Accept:"application/json; odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()},type:"GET",success:function(e){t.resolve({isExists:!0,data:e.d})},error:function(e){t.resolve({isExists:!1,data:null})}})})};return{ReadFile:n,UploadFile:o,CheckOutFile:t,CheckInFile:r,CopyFile:i,UpdateFileMetadata:a,ApproveFile:s,DoesFileExist:c}},Jello.List=function(){(function(){return{}})();throw"Not implemented"},Jello.ListItems=function(e){var t=function(){var e=null,t=function(){var t=$.Deferred();return e&&e.expiresOn>new Date?t.resolve(e):($.ajax({type:"POST",url:n+"/_api/contextinfo",headers:{accept:"application/json;odata=verbose"}}).done(function(r){var n=(new Date).getTime();e=r.d.GetContextWebInformation,e.expiresOn=n+1e3*r.d.GetContextWebInformation.FormDigestTimeoutSeconds-6e4,t.resolve(e)}).fail(function(e){console.log("Error fetching Request Digest. Some parts won't work."),t.reject(e)}),t.promise())};return{GetRequestDigest:t}}(),r={filter:null,expand:null,select:null,orderBy:null},n=e.site,o=e.list,i=e.contentType,a=function(e){var t=$.Deferred(),i="";return r.select||r.filter||r.expand||r.orderBy?(r.expand&&(i=i.length>0?i+"&"+r.expand:i+"?"+r.expand),r.select&&(i=i.length>0?i+"&"+r.select:i+"?"+r.select),r.filter&&(i=i.length>0?i+"&"+r.filter:i+"?"+r.filter),r.orderBy&&(i=i.length>0?i+"&"+r.orderBy:i+"?"+r.orderBy),e&&(i=i.length>0?i+"&$top="+e:i+"?$top="+e),r={filter:null,expand:null,select:null,orderBy:null}):i=e?"?$top="+e:"",url=n+"/_api/web/lists/getbytitle('"+o+"')/items"+i,$.ajax({type:"GET",headers:{accept:"application/json;odata=verbose"},url:url}).done(function(e){e.next=function(){var t=$.Deferred();return a(null,e.d.__next).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise()},e.prev=function(){var t=$.Deferred();return a(null,e.d.__prev).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise()},t.resolve(e)}).fail(function(e){t.reject(e)}),t.promise()},s=function(e){var t=$.Deferred();if(!e)throw"Provided ID is not valid";return $.ajax({type:"GET",headers:{accept:"application/json;odata=verbose"},url:n+"/_api/web/lists/getbytitle('"+o+"')/items("+e+")"}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t.promise()},c=function(e){var r=$.Deferred();return t.GetRequestDigest().then(function(t){e.__metadata={type:i};var a=JSON.stringify(e);$.ajax({type:"POST",headers:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose","X-RequestDigest":t},data:a,url:n+"/_api/web/lists/getbytitle('"+o+"')/items"}).done(function(e){r.resolve(e)}).fail(function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise()},l=function(e,r){r||(r="*");var i=$.Deferred();return t.GetRequestDigest().then(function(t){$.ajax({type:"POST",headers:{"X-RequestDigest":t,"X-HTTP-Method":"DELETE","If-Match":r},url:n+"/_api/web/lists/getbytitle('"+o+"')/items("+e+")"}).done(function(e){i.resolve(e)}).fail(function(e){i.reject(e)})},function(e){i.reject(e)}),i.promise()},u=function(e,r,a){a||(a="*");var s=$.Deferred();return t.GetRequestDigest().then(function(t){r.__metadata={type:i};var c=JSON.stringify(r);$.ajax({type:"POST",headers:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose","X-RequestDigest":t,"X-HTTP-Method":"MERGE","If-Match":a},data:c,url:n+"/_api/web/lists/getbytitle('"+o+"')/items("+e+")"}).done(function(e){s.resolve(e)}).fail(function(e){s.reject(e)})},function(e){s.reject(e)}),s.promise()},f=function(e){var t=$.Deferred();return e=e?"?"+e:"",$.ajax({type:"GET",headers:{accept:"application/json;odata=verbose"},url:n+"/_api/web/lists/getbytitle('"+o+"')/items"+e}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t.promise()},d=function(e){return r.filter="$filter="+e,this},p=function(e){return r.expand="$expand="+e,this},m=function(e){return r.select="$select="+e,this},v=function(e){return r.orderBy="$orderby="+e,this};return{get:a,getById:s,add:c,remove:l,update:u,query:f,where:d,expand:p,select:m,orderBy:v}},Jello.Taxonomy=function(e){if(!SP.Taxonomy)throw"SP.Taxonomy is not loaded. Please ensure SP.Taxonomy is loaded before proceeding.";if(!e.TermStore)throw"TermStore null or undefined";var t=e.TermStore,r=function(e){if(!e)throw"Term set ID null or undefined.";return $.Deferred(function(r){var n=SP.ClientContext.get_current(),o=SP.Taxonomy.TaxonomySession.getTaxonomySession(n),i=o.get_termStores(),a=i.getByName(t),s=a.getTermSet(e),c=s.getAllTerms();n.load(c),n.executeQueryAsync(function(){r.resolve(c)},function(e,t){r.reject(t)})})},n=function(e){if(!e||!e.Name||!e.GUID)throw"Name or GUID is null or undefined";return $.Deferred(function(r){var n=SP.ClientContext.get_current(),o=SP.Taxonomy.TaxonomySession.getTaxonomySession(n),i=o.get_termStores(),a=i.getByName(t),s=a.createGroup(e.Name,e.GUID);n.load(s),n.executeQueryAsync(function(){r.resolve(s)},function(e,t){r.reject(t)})})},o=function(e){if(!(e&&e.GroupGUID&&e.TermSetName&&e.TermSetGUID&&e.TermSetLCID))throw"One or more parameters null or undefined. Required parameters are GroupGUID, TermSetName, TermSetGUID, TermSetLCID";return $.Deferred(function(r){var n=SP.ClientContext.get_current(),o=SP.Taxonomy.TaxonomySession.getTaxonomySession(n),i=o.get_termStores(),a=i.getByName(t),s=a.getGroup(e.GroupGUID),c=s.createTermSet(e.TermSetName,e.TermSetGUID,e.TermSetLCID);n.load(c),n.executeQueryAsync(function(){r.resolve(c)},function(e,t){r.reject(t)})})},i=function(e){if(!(e&&e.TermSetGUID&&e.TermName&&e.TermLCID&&e.TermGUID))throw"One or more parameters null or undefined. Required parameters are TermSetGUID, TermName, TermLCID, TermGUID";return $.Deferred(function(r){var n=SP.ClientContext.get_current(),o=SP.Taxonomy.TaxonomySession.getTaxonomySession(n),i=o.get_termStores(),a=i.getByName(t),s=a.getTermSet(e.TermSetGUID),c=s.createTerm(e.TermName,e.TermLCID,e.TermGUID);c.set_isAvailableForTagging(e.isAvailableForTagging),n.load(c),n.executeQueryAsync(function(){r.resolve(c)},function(e,t){r.reject(t)})})},a=function(e){if(!e)throw"GUID is null or undefined.";return $.Deferred(function(t){var r='<View><Query><Where><Eq><FieldRef Name="IdForTerm"/><Value Type="Text">'+e+"</Value></Eq></Where></Query></View>",n=SP.ClientContext.get_current(),o=n.get_web().get_lists().getByTitle("TaxonomyHiddenList"),i=new SP.CamlQuery;i.set_viewXml(r);var a=o.getItems(i);n.load(a),n.executeQueryAsync(function(){for(var e=a.getEnumerator(),r=[];e.moveNext();){var n=e.get_current();r.push(n.get_id())}t.resolve(r)},function(e,r){t.reject(r)})})};return{getAllTerms:r,addTermGroup:n,addTermSet:o,addTerm:i,getWssIdFromGuid:a}},Jello.Web=function(){(function(){return{}})();throw"Not implemented"};