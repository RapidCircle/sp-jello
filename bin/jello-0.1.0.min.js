var Jello=function(e,t){if(!t.name||!t.contentType||!e)throw"Invalid settings";return{listName:t.name,listContentType:t.contentType,requestDigest:null,getRequestDigest:function(){var e=this,t=$.Deferred();return e.requestDigest&&e.requestDigest.expiresOn>new Date?t.resolve():($.ajax({type:"POST",url:"https://jello.sharepoint.com/sites/sprest/_api/contextinfo",headers:{accept:"application/json;odata=verbose"}}).done(function(n){var i=(new Date).getTime();e.requestDigest=n.d.GetContextWebInformation,e.requestDigest.expiresOn=i+1e3*n.d.GetContextWebInformation.FormDigestTimeoutSeconds-6e4,console.log("Token",e.requestDigest.FormDigestValue),t.resolve()}).fail(function(){console.log("Error fetching Request Digest. Some parts won't work."),t.reject()}),t.promise())},get:function(n){var i=$.Deferred(),s=n?"("+n+")":"";return $.ajax({type:"GET",headers:{accept:"application/json;odata=verbose"},url:e+"/_api/web/lists/getbytitle('"+t.name+"')/items"+s}).done(function(e){i.resolve(e)}).fail(function(e){i.reject(e)}),i.promise()},add:function(n){var i=this,s=$.Deferred();return this.getRequestDigest().then(function(){n.__metadata={type:i.listContentType};var o=JSON.stringify(n);$.ajax({type:"POST",headers:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose","X-RequestDigest":i.requestDigest.FormDigestValue},data:o,url:e+"/_api/web/lists/getbytitle('"+t.name+"')/items"}).done(function(e){s.resolve(e)}).fail(function(e){s.reject(e)})},function(e){s.reject(e)}),s.promise()},remove:function(n,i){i||(i="*");var s=this,o=$.Deferred();return this.getRequestDigest().then(function(){$.ajax({type:"POST",headers:{"X-RequestDigest":s.requestDigest.FormDigestValue,"X-HTTP-Method":"DELETE","If-Match":i},url:e+"/_api/web/lists/getbytitle('"+t.name+"')/items("+n+")"}).done(function(e){o.resolve(e)}).fail(function(e){o.reject(e)})},function(e){o.reject(e)}),o.promise()},update:function(n,i,s){s||(s="*");var o=this,r=$.Deferred();return this.getRequestDigest().then(function(){i.__metadata={type:o.listContentType};var a=JSON.stringify(i);$.ajax({type:"POST",headers:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose","X-RequestDigest":o.requestDigest.FormDigestValue,"X-HTTP-Method":"MERGE","If-Match":s},data:a,url:e+"/_api/web/lists/getbytitle('"+t.name+"')/items("+n+")"}).done(function(e){r.resolve(e)}).fail(function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise()}}};